<div class="container">
  <!-- Mensagem de feedback -->
  <div *ngIf="mensagem" [class]="'alert alert-' + (tipoMensagem === 'success' ? 'success' : 'danger')">
    {{ mensagem }}
  </div>

  <!-- Lista de Usuários -->
  <div class="card" *ngIf="!mostrarFormulario">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>Usuários Cadastrados</h3>
        <button class="btn btn-primary btn-novo" (click)="abrirFormularioCadastro()">
          <i class="fas fa-plus"></i> Novo Usuário
        </button>
      </div>

      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Usuário</th>
            <th>Email</th>
            <th>Perfil</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let usuario of usuarios">
            <td>{{ usuario.id }}</td>
            <td>{{ usuario.username }}</td>
            <td>{{ usuario.email }}</td>
            <td>{{ usuario.role }}</td>
            <td>
              <button class="btn btn-sm btn-warning me-2" (click)="editarUsuario(usuario)">
                Editar
              </button>
              <button class="btn btn-sm btn-danger" (click)="deletarUsuario(usuario.id)">
                Excluir
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Overlay e Card de Cadastro/Edição -->
  <div class="modal-overlay" *ngIf="mostrarFormulario"></div>
  <div class="cadastro-card" *ngIf="mostrarFormulario">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>{{ editando ? 'Editar Usuário' : 'Novo Usuário' }}</h3>
        <button class="btn btn-outline-secondary" (click)="cancelarEdicao()">
          <i class="fas fa-times"></i> Voltar
        </button>
      </div>

      <form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()">
        <div class="mb-3">
          <label for="username" class="form-label">Nome de Usuário</label>
          <input type="text" class="form-control" id="username" formControlName="username">
        </div>
        <div class="mb-3">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email" formControlName="email">
        </div>
        <div class="mb-3" *ngIf="!editando">
          <label for="password" class="form-label">Senha</label>
          <input type="password" class="form-control" id="password" formControlName="password">
        </div>
        <div class="mb-3">
          <label for="role" class="form-label">Perfil</label>
          <select class="form-select" id="role" formControlName="role">
            <option value="USER">Usuário</option>
            <option value="ADMIN">Administrador</option>
          </select>
        </div>
        <div class="d-flex justify-content-center gap-2 mt-4">
          <button type="submit" class="btn btn-primary" [disabled]="!usuarioForm.valid">
            {{ editando ? 'Atualizar' : 'Cadastrar' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>